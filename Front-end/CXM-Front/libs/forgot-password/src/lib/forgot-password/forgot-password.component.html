<!-- <cxm-smartflow-spinner *ngIf='showSpinner.value'></cxm-smartflow-spinner> -->
<cxm-smartflow-custom-header></cxm-smartflow-custom-header>

<div class='container' *ngIf='forgotState.nonExpired === true || forgotState.mode === 0'>
  <div [class.hidden]="forgotState.mode === 1" class='box-login relative bg-white md:bg-transparent'>
        <form #forgotForm [formGroup]='this.forgotPassword'>
          <div class="text-center mb-4 space-y-6">
            <div class="img-key">
              <img class="key-icon" src="assets/icons/key.svg" alt="Key">
            </div>
            <h1>{{'login.form.forgotPassword' | translate}}</h1>
          </div>

          <div [class.hidden]="forgotState.successMode === 1">
            <p class="mx-auto mb-4 text-center">{{'forgot-password.instruction'|translate}}</p>

            <div class="mt-auto mb-4">
              <label for="username">{{ 'login.form.username.label' | translate }}</label>
              <div>
                <input [placeholder]="'forgot-password.email_placeholder'|translate" type='email' id='email'formControlName='email' (keyup.enter)="forgot()"
                cxmSmartflowCxmTooltip
                [tooltipText]="(isEmailNotExisted ? 'forgot-password.emailNotFound' : 'login.form.username.error')|translate"
                [showTooltip]="isEmailError || isEmailNotExisted"
                normalBorderColorEl=""
                />
              </div>
            </div>

            <div class="justify-self-end">
              <button type="button" (click)="forgot()" class="mb-6">{{'forgot-password.reset' | translate}}</button>
              <div>
                <a class="mx-auto flex items-center justify-center align-middle" routerLink="/login">
                  <mat-icon class="mr-3" [inline]="true">arrow_back</mat-icon>
                  {{ 'forgot-password.returnHome' | translate }}</a>
              </div>
            </div>
          </div>

          <div [class.hidden]="forgotState.successMode !== 1">
            <p class="mx-auto mt-4 mb-8 text-center">{{'forgot-password.emailSent'|translate}}</p>
            <button type="button" (click)="backToLogin()" class="mb-4">{{'forgot-password.returnHomeLogin' | translate}}</button>
          </div>
        </form>
  </div>

  <div [class.hidden]="forgotState.mode === 0" class="box-login relative bg-white md:bg-transparent">
        <form #resetForm [formGroup]='this.resetPassword'>
          <div class="text-center mb-2 space-y-6">
            <div class="img-key">
              <img class="key-icon" src="assets/icons/key.svg" alt="Key">
            </div>
            <h1>{{'forgot-password.changePassword' | translate}}</h1>
          </div>

          <div [class.hidden]="forgotState.successMode === 2">

          <p class="mx-auto mb-8 text-center">{{'forgot-password.reset_instruction'|translate}}</p>

          <div class="mx-auto mb-4">
            <label for="password">{{ 'forgot-password.newPassword' | translate }}</label>
            <div class="relative">
              <input [type]="showPassword ? 'text' : 'password'" id='password' formControlName='password' (keyup.enter)='reset()'
              [placeholder]="'forgot-password.newPassword_placeholder'|translate"
              cxmSmartflowCxmTooltip
              [tooltipText]="'forgot-password.error_password_invalid'|translate"
              [showTooltip]="isPasswordError"
              normalBorderColorEl=""
              />

              <mat-icon (click)="togglerShowPw()" *ngIf="showPassword && getPassword.length > 0" class="showhide-icon">visibility_off</mat-icon>
              <mat-icon (click)="togglerShowPw()" *ngIf="!showPassword && getPassword.length > 0" class="showhide-icon">visibility</mat-icon>
            </div>
          </div>

          <div class="mx-auto mb-8">
            <label for="confirmPassword">{{ 'forgot-password.confirmPassword' | translate }}</label>
            <div class="relative">
              <input [type]="showPassword ? 'text' : 'password'" id='confirmPassword' formControlName='confirmPassword' (keyup.enter)='reset()'
              [placeholder]="'forgot-password.confirmPassword_placeholder'|translate"
              cxmSmartflowCxmTooltip
              [tooltipText]="'forgot-password.error_password_notmatch'|translate"
              [showTooltip]="isConfirmPasswordError"
              normalBorderColorEl=""
              />

              <mat-icon (click)="togglerShowPw()" *ngIf="showPassword && getConfirm.length > 0" class="showhide-icon">visibility_off</mat-icon>
              <mat-icon (click)="togglerShowPw()" *ngIf="!showPassword && getConfirm.length > 0" class="showhide-icon">visibility</mat-icon>
            </div>
          </div>

          <div class="justify-self-end">
            <button type="button" (click)="reset()" class="mb-4">{{'forgot-password.changePass' | translate}}</button>

            <!-- <div>
              <a class="mx-auto flex items-center justify-center align-middle" routerLink="/login">
                <mat-icon class="mr-3" [inline]="true">arrow_back</mat-icon>
                {{ 'forgot-password.returnHome' | translate }}</a>
            </div> -->
          </div>
          </div>

          <div [class.hidden]="forgotState.successMode !== 2" class='text-center'>
            <p class="mx-auto mt-4 mb-4 text-center">{{'forgot-password.passwordRested'|translate}}</p>
            <button (click)="backToLogin()" class="mb-4" style='width: 55%;'>{{'forgot-password.returnHomeConnector' | translate}}</button>
          </div>
        </form>
  </div>
</div>

<cxm-smartflow-footer [height]="66" [leftFooters]='leftFooters' [rightFooters]='rightFooters'></cxm-smartflow-footer>


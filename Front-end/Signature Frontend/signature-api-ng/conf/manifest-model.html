<!doctype html>
<html>

<head>
    <meta charset='UTF-8'>
    <title>tessi-manifest-template</title>
    <style type='text/css'>
        body {
            font-family: Helvetica, Arial, sans-serif;
            font-size: 13px;
            border:0;
            width: 100%;
            height: 100%;
            margin: 0;
            padding: 0;
            line-height: 1;
            background-color: #FFFFFF;
        }
        * {
            box-sizing: border-box;
            -moz-box-sizing: border-box;
        }

        .page, .longpage {
            width: 210mm;
            min-height: 277mm;
            padding: 1mm 18mm;
            margin: 10mm auto;
            border: 1px #D3D3D3 solid;
            border-radius: 5px;
            background: white;
            box-shadow: 0 0 5px rgba(0, 0, 0, 0.1);
        }
        .subpage {
            padding: 1cm;
            border: none;
            height: 238mm;
        }

        .sublongpage {
            padding: 1cm;
            border: none;
            min-height: 238mm;
        }

        h1 {
            font-size: 45px;
            font-weight: bold;
            text-align: center;
            color: #1A214D
        }
        h2 {
            font-size: 28px;
            font-weight: bold;
            text-align: center;
            color: #EA527E;
            margin-top: -1.5rem;
            margin-bottom: 3rem;
        }
        h3 {
            font-size: 24px;
            font-weight: bold;
            color:black;
            padding-bottom: 5px;
            border-bottom: 1px solid black ;
            margin-bottom: 1rem ;
        }
        h4 {
            font-size: 15px;
            font-weight: bold;
            color:black;
            border: none ;
            margin-top: 1rem ;
            margin-bottom: 0.25rem ;
        }
        p {
            margin-top: 0.4rem;
            text-align: justify;
        }
        p > span{
            font-weight: bold;
            color: #0070C0;
        }
        strong {
            color:#0c59b2;
            font-weight: bold;
        }
        
        table{
            table-layout: fixed !important;
            width:100%;
        }
        .td-md {
            width: 80px;
        }
        /*td {width: 300px !important;}*/
        table, th, tr, td  {
            border:none;
            border-spacing:0;
        }

        th, td {
            text-align: left !important;
            padding-left: 10px ;
            padding-right: 10px ;
            height:32px;
            word-wrap: break-word;
        }
        td {
            font-size:11px;
        }

        th {
            font-weight: bold;
            margin-left: 0 !important;
            margin-right: 0 !important;
        }
        thead {
            background-color: #F3F3F3;
        }
        table thead tr th{
            border-bottom: 1px solid #94A5BF;
        }
        hr {
            background: none ;
            height:1px ;
            border-top: 0px;
            border-left: 0px;
            border-right: 0px;
            border-bottom: 1px gray solid ;
            margin: 8px 0px 8px 0px ;
        }

        @page {
            size: A4;
            margin-top: 20mm !important;
            margin-bottom: 20mm !important;
        }
        @media print {
            html, body {
                width: 210mm;
                height: 297mm;        
            }
            .page, .longpage {
                margin: 0;
                border: 0;
                border-radius: 0;
                width: initial;
                min-height: initial;
                box-shadow: initial;
                background: initial;
                page-break-after: auto;
            }
        }

    </style>
</head>
<body>
    <div>
        <div class="page">
            <div class="subpage">
                <center>
                    <div >
                        <h1 style="font-size: 70px">Innovation&trust</h1>
                    </div>
                    <h1>Certigna Sign</h1>
                    <h2>Rapport de preuve</h2>
                </center>
                <p>Le présent document est un dossier technique généré lors d'une opération de signature électronique par le prestataire de confiance garant de l'opération.</p>
                <p>Dans son état natif, le dossier de preuve est élaboré dans un langage technique JSON. A partir du dossier de preuve d’origine en langage JSON, la société Innovation&trust France, prestataire de service de confiance, a élaboré le présent rapport de preuve qui est une représentation visuelle du contenu du dossier de preuve.</p>
                <p>
                    Ce rapport de preuve prouve l'intégrité et l'antériorité de cos documents numériques signés.
                    Pour apporter ces garanties, Innovation&trust France s'appuie sur des technologies reconnues juridiquement
                    qu'il maîtrise complètement : le transfert de ces documents vers le site de Innovation&trust France, la
                    constitution à cette occasion d'un scellement horodaté desdits documents ainsi que les processus
                    de signatures qui s'en suivent et la constitution du présent document que vous devez
                    garder comme preuve officielle d'intégrité et d'antériorité des documents signés.    
                </p>
                <p>Demande de signature créée par l’utilisateur initiateur: <strong>{{endUser.name}} {{endUser.email}}</strong></p>
                <p>Identifiant: <strong>{{reference}}</strong></p>
                <p>Modèle: <strong>{{templateName}}</strong></p>
                <p>Type: <strong>{{type}}</strong></p>
                <p>Date de création: <strong>{{date.toString('%A, %e %B %Y à %H:%M:%S')}}</strong></p>
                <p>Date dernière signature: <strong>{{signatureDate.toString('%A, %e %B %Y à %H:%M:%S')}}</strong></p>
                <p>Dernier état: <strong>{{status}}</strong></p>
            </div>    
        </div>
        <div class="page">
            <div class="subpage">
                <h3>PARTICIPANTS</h3>
                <table>
                    <thead>
                        <tr>
                            <th class="td-md">PublicId</th>
                            <th>Couriel</th>
                            <th class="td-md">Nom</th>
                            <th class="td-md">Prénom</th>
                            <th>No mobile</th>
                        </tr>
                    </thead>
                    <tbody>
                        <fusion type="enum" path="actors"><fusion type="enum" path="actor">
                            <tr>
                                <td>{{identifier}}</td>
                                <td>{{email.toLowerCase}}</td>
                                <td>{{name.toUpperCase}}</td>
                                <td>{{firstName.length?:{{firstName.capitalize}}}}{{firstName.length!:—}}</td>
                                <td>{{mobile.length?:{{mobile}}}}{{mobile.length!:—}}</td>
                            </tr>
                        </fusion></fusion>
                    </tbody>
                </table>
            </div>
        </div>
        <div class="page">
            <div class="subpage">
                <fusion path="documents.length.singular" type="if">
                    <h3>DOCUMENT APPROUVÉ ET SIGNÉ</h3>
                </fusion>
                <fusion path="documents.length.singular" type="ifnot">
                    <h3>DOCUMENTS APPROUVÉS ET SIGNÉS</h3>
                </fusion>
                <fusion path="documents" type="enum">
                    <fusion path="document" type="enum">
                        <p>Identifiant document: <strong>{{identifier}}</strong></p>
                        <p>Nom du document: <strong>{{fileName}}</strong></p>
                        <p>Titre du document: <strong>{{title}}</strong></p>
                    </fusion>
                    <p>Date ajout: <strong>{{creationDate.toString('%A, %e %B %Y à %H:%M:%S')}}</strong></p>
                    <p>Horodatage: <strong>{{signatureDate.toString('%A, %e %B %Y à %H:%M:%S')}}</strong></p>
                    <fusion path="signatures.length.singular" type="if">
                        <fusion path="signatures" type="enum">
                            <p>{{role}} par: <strong>{{actor.firstName.capitalize}} {{actor.name.toUpperCase}}</strong></p>
                            <fusion path="certificate.certificateData" type="enum">
                                <h4>Détail du certificat</h4>
                                <p>AKI: <strong>{{aki}}</strong></p>
                                <p>SKI: <strong>{{ski}}</strong></p>
                                <p>identifiant: <strong>{{id}}</strong></p>
                                <p>No série: <strong>{{serialnumber}}</strong></p>
                                <p>nom: <strong>{{givenName.capitalize}} {{surname.toUpperCase}}</strong></p>
                                <p>Validité: <strong>{{notBefore}} - {{notAfter}}</strong></p>
                            </fusion>
                        </fusion>
                    </fusion>
                    <fusion path="signatures.length.singular" type="ifnot">
                        <h4>Signatures</h4>
                        <table>
                            <thead>
                                <tr>
                                    <th class="td-md">Rôle</th>
                                    <th>Date</th>
                                    <th>Nom</th>
                                    <th>Prénom</th>
                                    <th>ID Certificat</th>
                                </tr>
                            </thead>
                            <tbody>
                                <fusion type="enum" path="signatures"><tr>
                                    <td>{{role}}</td>
                                    <td>{{date.toString('%e/%B/%Y à %H:%M:%S')}}</td>
                                    <td>{{actor.name.toUpperCase}}</td>
                                    <td>{{actor.firstName.length?:{{actor.firstName.capitalize}}}}{{actor.firstName.length!:—}}</td>
                                    <td>{{certificate?:{{certificate.certificateData.id}}}}{{certificate!:—}}</td>
                                </tr></fusion>
                            </tbody>
                        </table>
                    </fusion>
                    <fusion context="system" path="remaining" type="if"><hr /></fusion>
                </fusion>
            </div>
        </div>
        <fusion type="if" path="certificates.length">
            <div class="page">
                <div class="subpage">
                    <h3>LISTE DES CERTIFICATS</h3>
                    <fusion path="certificates" type="enum">
                        <fusion path="certificate.certificateData" type="enum">
                            <h4>Certificat ID {{id}}</h4>
                            <p>AKI: <strong>{{aki}}</strong></p>
                            <p>SKI: <strong>{{ski}}</strong></p>
                            <p>No série: <strong>{{serialnumber}}</strong></p>
                            <p>Nom: <strong>{{givenName.capitalize}} {{surname.toUpperCase}}</strong></p>
                            <p>Validité: <strong>{{notBefore}} - {{notAfter}}</strong></p>
                        </fusion>
                        <fusion path="remaining" type="if" context="system"><hr /></fusion>
                    </fusion>
                </div>
            </div>    
        </fusion>
        <div class="longpage">
            <div class="sublongpage">
                <h3>PISTE D'AUDIT</h3>
                <fusion path="events" type="enum">
                    <p>{{event}} le {{date.toString('%A, %e %B %Y à %H:%M:%S')}}{{hasActor?: par {{actorName}} (identifiant {{actorIdentifier}})}}. Cette opération a été enregistrée sous la référence {{operationId}}{{token.length?: avec l'OTP {{token}}}}{{documents.length?: pour les documents suivants:}}{{documents.length!:.}}</p>
                    <fusion path="documents.length" type="if">
                        <fusion path="reason" type="if">
                            <p>Raison: {{reason}} </p>
                        </fusion>
                    </fusion>
                    <fusion type="if" path="documents.length">
                        <ul><fusion type="enum" path="documents">
                            <li>{{fileName}} (id: {{identifier}})</li>
                        </fusion></ul>
                    </fusion>
                    <fusion path="remaining" type="if" context="system"><hr /></fusion>
                </fusion>
            </div>
        </div>
    </div>
</body>
</html>
